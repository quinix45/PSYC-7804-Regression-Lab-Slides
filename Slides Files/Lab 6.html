<!DOCTYPE html>
<html lang="en"><head>
<script src="Lab 6_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab 6_files/libs/quarto-html/tabby.min.js"></script>
<script src="Lab 6_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab 6_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Lab 6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab 6_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Lab 6_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="Lab 6_files/libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="Lab 6_files/libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Fabio Setti">
  <title>Lab 6: Semi-partial, Partial-correlations, and Model Comparison</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Lab 6_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Lab 6_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="Lab 6_files/libs/revealjs/dist/theme/quarto-9ff94dc1d5aad2ccdc9352ac53b71824.css">
  <link href="Lab 6_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Lab 6_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Lab 6_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Lab 6_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Lab 6_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Lab 6_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="Lab 6_files/libs/core-js-2.5.3/shim.min.js"></script>

  <script src="Lab 6_files/libs/react-18.2.0/react.min.js"></script>

  <script src="Lab 6_files/libs/react-18.2.0/react-dom.min.js"></script>

  <script src="Lab 6_files/libs/reactwidget-2.0.0/react-tools.js"></script>

  <script src="Lab 6_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

  <link href="Lab 6_files/libs/reactable-0.4.4/reactable.css" rel="stylesheet">

  <script src="Lab 6_files/libs/reactable-binding-0.4.4/reactable.js"></script>

  <script src="Fabio_theme/Fabio_theme.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-transition="zoom" data-visibility="uncounted" class="quarto-title-block center">
  <h1 class="title">Lab 6: Semi-partial, Partial-correlations, and Model Comparison</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Fabio Setti 
</div>
        <p class="quarto-title-affiliation">
            PSYC 7804 - Regression with Lab
          </p>
    </div>
</div>

</section>

<section id="todays-packages-and-data" class="slide level2">
<h2>Today’s Packages and Data 🤗</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell code-150">
<details class="code-fold">
<summary>Install Packages Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ppcor"</span>)</span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell code-150">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor)</span>
<span id="cb2-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">16</span>, </span>
<span id="cb2-4"><a href="" aria-hidden="true" tabindex="-1"></a>                        <span class="at">base_family =</span> <span class="st">'serif'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div style="font-size: 26px">
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1"><code>ppcor</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<p>The <code>ppcor</code> package <span class="citation" data-cites="Kim_2015">(<a href="#/references" role="doc-biblioref" onclick="">Kim, 2015</a>)</span> contains functions to calculate partial and semi-partial correlations.</p>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<center>
<strong>Data</strong>
</center>
<p><br></p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Data from https://library.virginia.edu/data/articles/hierarchical-linear-regression</span></span>
<span id="cb3-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"https://github.com/quinix45/PSYC-7804-Regression-Lab-Slides/raw/refs/heads/main/Slides%20Files/Data/Hierarc_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-1acc1c751c79fbab962e" class="reactable html-widget" style="width:auto;height:350px;"></div>
<script type="application/json" data-for="htmlwidget-1acc1c751c79fbab962e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"happiness":[5,5,6,4,3,5,5,5,4,4,7,3,2,7,6,7,9,3,4,6,4,4,4,5,5,7,5,3,3,4,4,1,5,5,1,4,4,3,6,6,5,5,2,5,5,7,1,2,2,5,4,4,5,7,4,4,6,4,5,2,7,5,7,3,3,7,7,6,4,3,6,4,3,3,4,4,4,2,3,6,5,5,5,5,6,4,3,2,3,4,3,4,5,4,4,4,6,5,7,4],"age":[24,28,25,26,20,25,24,24,26,26,25,25,28,24,29,26,24,28,24,24,25,24,25,27,26,24,24,28,28,23,24,25,28,23,26,28,24,24,25,23,25,27,25,24,27,25,23,30,27,22,25,24,21,23,26,22,29,23,25,25,27,27,24,24,27,28,25,23,25,27,28,26,22,26,26,27,26,27,26,25,27,27,27,24,23,30,24,27,25,26,28,27,23,27,25,24,26,25,21,28],"friends":[12,8,6,4,8,9,5,6,8,6,4,9,4,5,14,8,10,6,13,7,4,11,2,7,9,10,10,7,4,9,7,7,9,8,5,10,3,1,7,8,8,6,8,6,8,7,4,4,5,12,6,4,4,8,9,8,8,12,5,2,10,5,6,10,6,11,10,3,3,6,8,8,6,5,7,6,10,1,8,7,7,11,7,10,4,5,10,5,5,8,8,6,5,5,5,4,10,7,7,5],"pets":[3,1,0,2,0,0,5,2,1,4,1,0,1,4,1,2,2,1,4,3,3,1,2,2,3,2,4,3,1,1,0,0,3,1,1,1,1,0,0,1,0,1,0,2,0,2,0,1,1,0,0,0,0,1,0,0,2,1,1,0,1,0,0,1,1,2,1,2,0,0,0,2,1,0,0,0,0,0,0,0,1,1,2,2,1,0,0,0,0,0,1,2,2,0,2,1,0,0,3,2],"gender":["Male","Male","Female","Male","Female","Male","Male","Male","Male","Male","Male","Female","Male","Male","Male","Female","Male","Male","Male","Male","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Female","Male","Male","Male","Male","Female","Male","Male","Female","Female","Male","Male","Male","Male","Male","Male","Female","Female","Male","Male","Female","Female","Female","Male","Male","Male","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Male","Male","Male","Male","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Male","Male","Female","Male","Male","Female","Female","Male","Male","Male","Male","Female","Female","Female","Male","Female","Male","Male"]},"columns":[{"id":"happiness","name":"happiness","type":"numeric"},{"id":"age","name":"age","type":"numeric"},{"id":"friends","name":"friends","type":"numeric"},{"id":"pets","name":"pets","type":"numeric"},{"id":"gender","name":"gender","type":"character"}],"pagination":false,"highlight":true,"style":{"fontFamily":"Work Sans, sans-serif","fontSize":"1.175rem"},"height":"350px","dataKey":"6b243c2697c2bf137172da943f57a121"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div></div>
</section>
<section id="our-predictors" class="slide level2">
<h2>Our Predictors</h2>
<p>We want to see how happiness (<code>happiness</code>) relates to age (<code>age</code>), and number of friends (<code>friends</code>).</p>
<div class="columns">
<div class="column" style="width:60%;">
<p>We can calculate the correlation among our predictors</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           happiness         age     friends
happiness  1.0000000 -0.16091772  0.32424344
age       -0.1609177  1.00000000 -0.02097324
friends    0.3242434 -0.02097324  1.00000000</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="fragment" data-fragment-index="1">
<p>Although useful, correlation by itself may not be the measure we are interested in. Rather, we may want to know the relationship between two variables <em>after</em> accounting for another set of variables.</p>
</div>
</div></div>
<p><br></p>
<div class="fragment" data-fragment-index="2">
<p><strong>Partial correlation</strong> and <strong>semi-partial correlation</strong> are what we are looking for in this case.</p>
</div>
</section>
<section id="some-formulas-for-reference" class="slide level2">
<h2>Some Formulas for Reference</h2>
<p>If <span class="math inline">\(r_{xy}\)</span> represent the <a href="https://raw.githack.com/quinix45/PSYC-7804-Regression-Lab-Slides/main/Slides%20Files/Lab%202.html#/correlation" target="_blank">correlation</a> between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, then</p>
<div class="fragment" data-fragment-index="1">
<ul>
<li><p><strong>Partial correlation</strong>:</p>
<ul>
<li><span class="math inline">\(r_{xy.z} = \frac{r_{xy} - r_{xz} \times r_{yz}}{\sqrt{1 - r_{xz}^2}\times\sqrt{1 - r_{yz}^2}}\)</span>, where <span class="math inline">\(z\)</span> is controlled for both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span></li>
</ul></li>
</ul>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li><strong>Semi-partial correlation</strong>: In semi-partial correlation, the <span class="math inline">\(z\)</span> variable is held constant only for 1 of the other 2 variables. That means that in our case, there are 2 semi-partial correlations that can be calculated</li>
</ul>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="3">
<ul>
<li><span class="math inline">\(r_{x(y.z)} = \frac{r_{xy} - r_{xz} \times r_{yz}}{\sqrt{1 - r_{yz}^2}}\)</span>,</li>
</ul>
<p>where <span class="math inline">\(z\)</span> is controlled only for <span class="math inline">\(y\)</span></p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="4">
<ul>
<li><span class="math inline">\(r_{y(x.z)} = \frac{r_{xy} - r_{xz} \times r_{yz}}{\sqrt{1 - r_{xz}^2}}\)</span>,</li>
</ul>
<p>where <span class="math inline">\(z\)</span> is controlled only for <span class="math inline">\(x\)</span></p>
</div>
</div></div>
<div class="fragment" data-fragment-index="5">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>spot differences and similarities in related formulas</strong></p>
</div>
<div class="callout-content">
<p>Notice that the numerator (top part) of these formulas is always the same, and the denominator (bottom part) changes slightly. This means that if you want to understand the differences, you should not look at the numerator at all (pretend it does not exist!), but only at the denominator.</p>
</div>
</div>
</div>
</div>
</section>
<section id="partial-correlation-by-hand" class="slide level2">
<h2>Partial Correlation “by hand”</h2>
<p>As always, I like calculating things by hand first to make sure I know what is going on 🤷 Let’s say that <span class="math inline">\(y =\)</span> <code>happiness</code>, <span class="math inline">\(x =\)</span> <code>age</code>, and <span class="math inline">\(z =\)</span> <code>friends</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="1">
<p>Let’s first get our vanilla correlations</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="" aria-hidden="true" tabindex="-1"></a>r_xy <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat<span class="sc">$</span>age, dat<span class="sc">$</span>happiness)</span>
<span id="cb6-2"><a href="" aria-hidden="true" tabindex="-1"></a>r_xz <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat<span class="sc">$</span>age, dat<span class="sc">$</span>friends)</span>
<span id="cb6-3"><a href="" aria-hidden="true" tabindex="-1"></a>r_yz <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat<span class="sc">$</span>happiness, dat<span class="sc">$</span>friends)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment" data-fragment-index="2">
<p>Then, the partial correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, accounting for <span class="math inline">\(z\)</span> is</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a>(r_xy <span class="sc">-</span> r_xz<span class="sc">*</span>r_yz)<span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> r_xz<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> r_yz<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.162955</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="3">
<p>Note that this is also equivalent to calculating the correlation between the residuals of <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> after a regression with <span class="math inline">\(z\)</span> as a predictor</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a>resid_y_z <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="fu">lm</span>(happiness <span class="sc">~</span> friends, dat))</span>
<span id="cb9-2"><a href="" aria-hidden="true" tabindex="-1"></a>resid_x_z <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="fu">lm</span>(age <span class="sc">~</span> friends, dat))</span>
<span id="cb9-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(resid_x_z, resid_y_z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.162955</code></pre>
</div>
</div>
</div>
</div></div>
<div class="fragment" data-fragment-index="4">
<p>So, <span class="math inline">\(r_{xy.z}-.16\)</span> is the correlation between <code>happiness</code> and <code>age</code> after taking out the proportion of variance explained by <code>friends</code> in both variables.</p>
</div>
</section>
<section id="semi-partial-correlation-by-hand" class="slide level2">
<h2>Semi-Partial Correlation “by hand”</h2>
<p>The semi-partial correlations between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> accounting for <span class="math inline">\(z\)</span> can either be:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="1">
<p>With the formulas from the previous slides:</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>(r_xy <span class="sc">-</span> r_xz<span class="sc">*</span>r_yz)<span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> r_xz<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1541512</code></pre>
</div>
</div>
<p>or</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a>(r_xy <span class="sc">-</span> r_xz<span class="sc">*</span>r_yz)<span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> r_yz<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1629192</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<p>Similarly, we can get this by using regression residuals:</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dat<span class="sc">$</span>happiness, resid_x_z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1541512</code></pre>
</div>
</div>
<p>and</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dat<span class="sc">$</span>age, resid_y_z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1629192</code></pre>
</div>
</div>
</div>
</div></div>
<div class="fragment" data-fragment-index="3">
<ul>
<li><p><span class="math inline">\(r_{y(x.z)} = -.15\)</span> represents the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> after the taking out of <span class="math inline">\(x\)</span> the variance explained by <span class="math inline">\(z\)</span>.</p></li>
<li><p><span class="math inline">\(r_{x(y.z)} = -.16\)</span> represents the relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> after the taking out of <span class="math inline">\(y\)</span> the variance explained by <span class="math inline">\(z\)</span>.</p></li>
</ul>
</div>
<div class="fragment" data-fragment-index="4">
<center>
Which type of correlation to use? <strong>it depends on your research question</strong>
</center>
</div>
</section>
<section id="using-ppcor-functions" class="slide level2">
<h2>Using <code>ppcor</code> Functions</h2>
<p>In practice, we use the <code>ppcor</code> package</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># partial correlation</span></span>
<span id="cb19-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="" aria-hidden="true" tabindex="-1"></a>partial_cor <span class="ot">&lt;-</span> <span class="fu">pcor</span>(dat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb19-4"><a href="" aria-hidden="true" tabindex="-1"></a>partial_cor<span class="sc">$</span>estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           happiness        age   friends
happiness  1.0000000 -0.1629550 0.3251768
age       -0.1629550  1.0000000 0.0334209
friends    0.3251768  0.0334209 1.0000000</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># semi-partial correlation</span></span>
<span id="cb21-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="" aria-hidden="true" tabindex="-1"></a>semipartial_cor <span class="ot">&lt;-</span> <span class="fu">spcor</span>(dat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb21-4"><a href="" aria-hidden="true" tabindex="-1"></a>semipartial_cor<span class="sc">$</span>estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           happiness         age    friends
happiness  1.0000000 -0.15415119 0.32093907
age       -0.1629192  1.00000000 0.03298535
friends    0.3251053  0.03161529 1.00000000</code></pre>
</div>
</div>
<div style="font-size: 20px">
Careful! in the semi-partial correlation output, the variable in the row is the variable that has no variance taken out.
</div>
</div></div>
<div class="fragment" data-fragment-index="1">
<p>The functions from <code>ppcor</code> work in the same way as the ones used in <a href="https://raw.githack.com/quinix45/PSYC-7804-Regression-Lab-Slides/main/Slides%20Files/Lab%202.html#/corr_test-output" target="_blank">Lab 2</a>, where significance and other information is saved to a separate element.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="" aria-hidden="true" tabindex="-1"></a>partial_cor<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           happiness       age    friends
happiness 0.00000000 0.1070529 0.00102305
age       0.10705291 0.0000000 0.74260755
friends   0.00102305 0.7426075 0.00000000</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="" aria-hidden="true" tabindex="-1"></a>semipartial_cor<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            happiness       age     friends
happiness 0.000000000 0.1276520 0.001200009
age       0.107131170 0.0000000 0.745847111
friends   0.001025828 0.7560662 0.000000000</code></pre>
</div>
</div>
</div></div>
</div>
</section>
<section id="model-comparison-gain-in-prediction" class="slide level2">
<h2>Model Comparison: Gain in Prediction</h2>
<p>We are often (actually always) interested in comparing different models. One often relevant question is: “is it <em>worth it</em> to add more variables as predictors?”</p>
<div class="fragment" data-fragment-index="1">
<p>In the case of regression, the most popular way of comparing models is by comparing <span class="math inline">\(R^2\)</span> from <a href="https://www.statology.org/nested-model/" target="_blank">nested models</a>. Let’s go back to how happiness (<code>happiness</code>) relates to age (<code>age</code>); then, we want to know whether adding number of friends (<code>friends</code>) improves our prediction.</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a>reg_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> age, dat)</span>
<span id="cb27-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_age)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02589451</code></pre>
</div>
</div>
<p>So <code>age</code> roughly explains <span class="math inline">\(3\%\)</span> of the variance in <code>happiness</code></p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="3">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="" aria-hidden="true" tabindex="-1"></a>reg_age_fr <span class="ot">&lt;-</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> age <span class="sc">+</span> friends, dat)</span>
<span id="cb29-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_age_fr)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1288964</code></pre>
</div>
</div>
<p><code>age</code> and <code>friends</code> together roughly explains <span class="math inline">\(13\%\)</span> of the variance in <code>happiness</code></p>
</div>
</div></div>
<div class="fragment" data-fragment-index="4">
<p>The answer seems fairly straightforward: the model with both <code>age</code> and <code>friends</code> does better. But there is a catch with <span class="math inline">\(R^2\)</span> 🤨</p>
</div>
</section>
<section id="the-catch-with-r2" class="slide level2">
<h2>The catch With <span class="math inline">\(R^2\)</span></h2>
<p>The “problem” with most popular measures of model fit such as <span class="math inline">\(R^2\)</span> is that they always increase as variables are added, even when the added variables are unrelated to <span class="math inline">\(Y\)</span>.</p>
<div class="columns">
<div class="column" style="width:70%;">
<div class="fragment" data-fragment-index="1">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># generate random variable</span></span>
<span id="cb31-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8879</span>)</span>
<span id="cb31-3"><a href="" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>random_var <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(dat))</span>
<span id="cb31-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="" aria-hidden="true" tabindex="-1"></a>reg_age_fr_rand <span class="ot">&lt;-</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> age <span class="sc">+</span> friends <span class="sc">+</span> random_var, dat)</span>
<span id="cb31-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># before</span></span>
<span id="cb31-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_age_fr)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1288964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># after </span></span>
<span id="cb33-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_age_fr_rand)<span class="sc">$</span>r.squared </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1361937</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:30%;">
<div class="fragment" data-fragment-index="2">
<p><span class="math inline">\(R^2\)</span> increases When we add a random variable 😦</p>
</div>
<div class="fragment" data-fragment-index="3">
<p>However, this is certainly a case where adding a randomly generated variable is <em>not worth it</em>.</p>
</div>
</div></div>
<div class="fragment" data-fragment-index="4">
<p>We want to apply the principle of <a href="https://www.britannica.com/topic/Occams-razor" target="_blank">Occam’s razor</a>, and choose the simpler model if the increase in <span class="math inline">\(R^2\)</span> is not worth it.</p>
</div>
</section>
<section id="testing-gain-in-prediction-delta-r2" class="slide level2">
<h2>Testing gain in prediction: <span class="math inline">\(\Delta R^2\)</span></h2>
<p>In hierarchical regression we check whether adding variables to a model yields a significant <span class="math inline">\(R^2\)</span> improvement (<span class="math inline">\(\Delta R^2\)</span>). We can use the <code>anova()</code> function to compare nested regression models. The <em>F</em>-test tells us whether the <span class="math inline">\(R^2\)</span> improvement is significant.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="1">
<div class="cell code-115">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(reg_age, reg_age_fr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: happiness ~ age
Model 2: happiness ~ age + friends
  Res.Df   RSS Df Sum of Sq     F   Pr(&gt;F)   
1     98 234.6                               
2     97 209.8  1    24.807 11.47 0.001023 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div style="font-size: 23px">
Here, adding <code>friends</code> provides a significant improvement in variance explained, <span class="math inline">\(\Delta R^2 = .1, F(1, 97) = 11.47, p = .001\)</span>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(reg_age_fr, reg_age_fr_rand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: happiness ~ age + friends
Model 2: happiness ~ age + friends + random_var
  Res.Df    RSS Df Sum of Sq     F Pr(&gt;F)
1     97 209.80                          
2     96 208.04  1    1.7575 0.811 0.3701</code></pre>
</div>
</div>
<div style="font-size: 23px">
Unsurprisingly, adding adding a random variable does not provide a significant improvement in variance explained, <span class="math inline">\(\Delta R^2 = .01, F(1, 96) = 0.81, p = .37\)</span>.
</div>
</div>
</div></div>
<p><br></p>
<div class="fragment" data-fragment-index="3">
<div style="font-size: 20px">
<strong>Note</strong>: For reporting, you need to calculate the difference between the <span class="math inline">\(R^2\)</span> of the two regression models, the <span class="math inline">\(\Delta R^2\)</span>, by hand.
</div>
</div>
</section>
<section id="information-criteria-for-model-selection" class="slide level2">
<h2>Information Criteria for Model Selection</h2>
<p>There also exist a family of statistics used for comparing model based on <a href="https://en.wikipedia.org/wiki/Information_theory" target="_blank">information theory</a>. What you will often see are the Akaike information criterion <span class="citation" data-cites="Akaike_1974">(AIC; <a href="#/references" role="doc-biblioref" onclick="">Akaike, 1974</a>)</span> and Bayesian information criterion <span class="citation" data-cites="Schwarz_1978">(BIC; <a href="#/references" role="doc-biblioref" onclick="">Schwarz, 1978</a>)</span>.</p>
<div class="fragment" data-fragment-index="1">
<p>Both AIC and BIC calculate model fit, and then penalize it based on model complexity (number of estimated <a href="https://en.wikipedia.org/wiki/Statistical_parameter" target="_blank">parameters</a>). The logic is that if you are going to add an extra variable to a regression, it should improve fit enough to offset the penalty term. For regression:</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<p><span class="math display">\[AIC = N \times ln(\frac{SS_{\mathrm{resisuals}}}{N}) + 2p\]</span></p>
<p><span class="math inline">\(N =\)</span> sample size</p>
<p><span class="math inline">\(p =\)</span> number of model parameters (i.e., intercept, slopes, residual variance)</p>
<p><span class="math inline">\(SS =\)</span> sum of squares of the residuals</p>
<p><span class="math inline">\(ln() =\)</span> stands for the natural log</p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<p><span class="math display">\[BIC =  N \times ln(\frac{SS_{\mathrm{resisuals}}}{N}) + p\times ln(N)\]</span></p>
</div>
<div class="fragment" data-fragment-index="3">
<p>The <span class="math inline">\(N \times ln(\frac{SS_{\mathrm{resisuals}}}{N})\)</span> part, which is shared by both formulas, measures model fit. In contrast <span class="math inline">\(2p\)</span> is the AIC penalty, while <span class="math inline">\(p\times ln(N)\)</span> is the BIC penalty. The BIC penalty is stricter.</p>
</div>
</div></div>
</section>
<section id="the-aic-and-bic-functions" class="slide level2">
<h2>The <code>AIC()</code> and <code>BIC()</code> Functions</h2>
<p>We can calculate both AIC and BIC for all our models at once with the <code>AIC()</code> and <code>BIC()</code> functions. Both for AIC and BIC, the smallest value is the model that fits best according to the criteria.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(reg_age, reg_age_fr, reg_age_fr_rand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                df      AIC
reg_age          3 375.0604
reg_age_fr       4 365.8845
reg_age_fr_rand  5 367.0433</code></pre>
</div>
</div>
<p>The second model fits best.</p>
</div><div class="column" style="width:50%;">
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(reg_age,reg_age_fr, reg_age_fr_rand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                df      BIC
reg_age          3 382.8759
reg_age_fr       4 376.3052
reg_age_fr_rand  5 380.0691</code></pre>
</div>
</div>
<p>The second model fits best.</p>
</div></div>
<div class="fragment" data-fragment-index="1">
<p>In both cases the second model fits best because the addition of the random variable is not enough to offset the penalty for adding an additional variable (ok, that is to be expected, we added a random variable).</p>
</div>
<div class="fragment" data-fragment-index="2">
<p>Although, AIC and BIC can disagree (often in my experience!). Usually, AIC likes more complex models, while BIC prefers simpler models. If I have to choose, I tend to trust BIC more.</p>
</div>
<div class="fragment" data-fragment-index="3">
<p>Finally, information criteria like the AIC and BIC can be used to compare non-nested models (the data must be the same though), unlike <span class="math inline">\(\Delta R^2\)</span>, which can only be used to compare nested models.</p>
</div>
</section>
<section id="caveats-with-aic-and-bic" class="slide level2">
<h2>Caveats With AIC and BIC</h2>
<p>There are a couple of caveats to be aware of when using AIC and BIC.</p>
<ol style="font-size: 26px">
<div class="fragment" data-fragment-index="1">
<li>
<p>Different functions/software will calculate AIC and BIC differently (I was confused for a bit myself before finding <a href="https://robjhyndman.com/hyndsight/lm_aic.html" target="_blank">this</a> and <a href="https://stackoverflow.com/questions/64531074/why-do-statsmodels-and-r-disagree-on-aic-computation" target="_blank">this</a>). You should not compare AIC and BIC if they come from different functions/software (or, if you need to, be <em>very</em> careful).</p>
<div class="cell code-125">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(reg_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 375.0604</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">extractAIC</span>(reg_age)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 89.2727</code></pre>
</div>
</div>
<p>The <code>AIC()</code> function adds a <span class="math inline">\(N \times \mathrm{ln}(2\pi) + N\)</span> to the AIC (for math reasons), but other functions may not. So always use the same function/software to calculate AIC and BIC.</p>
</li>
</div>
<div class="fragment" data-fragment-index="2">
<li>
AIC and BIC do not tell you <em>how much better</em> a model fits over another. So, you may reject a model that practically is quite similar to the model you chose, but you will not know that by looking at AIC and BIC alone. Your theory should also guide the model selection choices that you make.
</li>
</div>

</ol></section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Akaike_1974" class="csl-entry" role="listitem">
Akaike, H. (1974). A new look at the statistical model identification. <em>IEEE Transactions on Automatic Control</em>, <em>19</em>(6), 716–723. <a href="https://doi.org/10.1109/TAC.1974.1100705">https://doi.org/10.1109/TAC.1974.1100705</a>
</div>
<div id="ref-Kim_2015" class="csl-entry" role="listitem">
Kim, S. (2015). Ppcor: <span>An R Package</span> for a <span>Fast Calculation</span> to <span class="nocase">Semi-partial Correlation Coefficients</span>. <em>Communications for Statistical Applications and Methods</em>, <em>22</em>(6), 665–674. <a href="https://doi.org/10.5351/CSAM.2015.22.6.665">https://doi.org/10.5351/CSAM.2015.22.6.665</a>
</div>
<div id="ref-Schwarz_1978" class="csl-entry" role="listitem">
Schwarz, G. (1978). Estimating the <span>Dimension</span> of a <span>Model</span>. <em>The Annals of Statistics</em>, <em>6</em>(2), 461–464. <a href="https://doi.org/10.1214/aos/1176344136">https://doi.org/10.1214/aos/1176344136</a>
</div>
<div id="ref-Wickham_RStudio_2023" class="csl-entry" role="listitem">
Wickham, H., &amp; RStudio. (2023). <em>Tidyverse: <span>Easily Install</span> and <span>Load</span> the ’<span>Tidyverse</span>’</em> (Version 2.0.0) [Computer software]. <a href="https://cran.r-project.org/web/packages/tidyverse/index.html">https://cran.r-project.org/web/packages/tidyverse/index.html</a>
</div>
</div>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Lab 6: Semi-Partial, Partial-Correlations, and Model Comparison</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Lab 6_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Lab 6_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Lab 6_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Lab 6_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>